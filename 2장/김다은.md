# 1. UserDaoTest
## 1.1 ê¸°ì¡´ UserDaoTest

- `ê¸°ì¡´ userDaoTest`
    - main í•¨ìˆ˜ë¥¼ ì´ìš©í•´ í…ŒìŠ¤íŠ¸ ì§„í–‰
    - UserDaoì˜ objë¥¼ ê°€ì ¸ì™€ ë©”ì†Œë“œ í˜¸ì¶œ
    - ì…ë ¥ ê°’ì„ ì§ì ‘ ì½”ë“œì—ì„œ ë§Œë“¤ì–´ ë„£ìŒ
    - ê²°ê³¼ë¥¼ ì½˜ì†”ì— ì¶œë ¥
    - ê° ë‹¨ê³„ì˜ ì‘ì—…ì´ ì—ëŸ¬ ì—†ì´ ëë‚˜ë©´ ì½˜ì†”ì— ì„±ê³µ ë©”ì‹œì§€ ì¶œë ¥
    
    ```java
    public class UserDaoTest {
    	public static void main(String[] args) throws SQLException {
    		Applicationcontext context = new GenericXmlApplicationContext(
    		"applicationcontext.xml") ï¼›
    		
    		UserDao dao = context.getBean("userDao", UserDao.class)ï¼›
    		
    		User user = new User();
    		user.setld("user");
    		user. setName("ë°±ê¸°ì„ ");
    		user.setPassword("married");
    		dao.add(user);
    		
    		System.out.println(user.getId() + " ë“±ë¡ ì„±ê³µ");
    		
    		User user2 = dao.get(user.getId());
    		System.out.println(user2.getName());
    		System.out.println(user2.getPassword());
    		
    		System.out.println(user2.getId() + "ì¡°íšŒ ì„±ê³µ");
    	}
    }
    ```
<br>


### 1.1.1 ì›¹ì„ í†µí•œ DAO í…ŒìŠ¤íŠ¸

- ë³´í†µ ì›¹ í”„ë¡œê·¸ë¨ì—ì„œ DAOë¥¼ í…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•
    - ëª¨ë“  ì…ì¶œë ¥ ê¸°ëŠ¥ì„ ìƒì„± (MVC, ì„œë¹„ìŠ¤ ê³„ì¸µ í¬í•¨)
    - ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì„œë²„ì— ë°°ì¹˜í•œ í›„ í¼ì„ ì—´ê³  ë“¤ì–´ì˜¨ ê°’ íŒŒì‹±
    - User objë¥¼ ë§Œë“¤ê³  UserDao í˜¸ì¶œ
    - URLì„ ì‚¬ìš©í•´ í•´ë‹¹ ë°ì´í„° ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ”ì§€ í™•ì¸
- ëª¨ë“  ë ˆì´ì–´ì˜ ê¸°ëŠ¥ì„ ë‹¤ ë§Œë“¤ì–´ì•¼ í•˜ë©° ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì„ ì‹œ ìœ„ì¹˜ë¥¼ ì§ì ‘ ì°¾ì•„ì•¼ í•˜ê¸° ë•Œë¬¸ì— ë²ˆê±°ë¡œì›€
- ì¦‰, í…ŒìŠ¤íŠ¸í•˜ë ¤ëŠ” ëŒ€ìƒì— ì§‘ì¤‘í•˜ì§€ ëª»í•˜ê³  ì˜¤ë¥˜ê°€ ìˆì„ ë•Œ ì •í™•í•˜ê³  ë¹ ë¥´ê²Œ ëŒ€ì‘í•˜ê¸°ê°€ í˜ë“¦

<br>

### 1.1.2 ë‹¨ìœ„í…ŒìŠ¤íŠ¸

- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ : ì‘ì€ ë‹¨ìœ„ì˜ ì½”ë“œì— ëŒ€í•´ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰
    - ë‹¨ìœ„ì˜ ë²”ìœ„ê°€ ëª…í™•í•˜ê²Œ ì •í•´ì§€ì§„ ì•Šìœ¼ë‚˜, í•˜ë‚˜ì˜ ê´€ì‹¬ì— ì§‘ì¤‘í•´ì„œ íš¨ìœ¨ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” ì •ë„ë¥¼ ëœ»í•¨
- DBë¥¼ ê°™ì´ ì‚¬ìš©í•´ë„ ë‹¨ìœ„  í…ŒìŠ¤íŠ¸ì¸ê°€ ?
    - DBì˜ ìƒíƒœë¥¼ í…ŒìŠ¤íŠ¸ê°€ ê´€ì¥í•˜ê³  ìˆë‹¤ë©´ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì„
    - DB ìƒíƒœê°€ ë§¤ë²ˆ ë‹¬ë¼ì§„ë‹¤ë©´ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì˜ ê°€ì¹˜ ìƒì‹¤
    - â†’ **í†µì œí•  ìˆ˜ ì—†ëŠ” ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ì— ì˜ì¡´í•˜ëŠ” í…ŒìŠ¤íŠ¸ëŠ” ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ê°€ ì•„ë‹˜**
- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ê°€ í•„ìš”í•œ ì´ìœ 
    - ì„¤ê³„ëœ ì½”ë“œê°€ ì˜ë„ëŒ€ë¡œ ë™ì‘í•˜ëŠ”ì§€ ê°œë°œì ìŠ¤ìŠ¤ë¡œ ë¹¨ë¦¬ í™•ì¸í•˜ê¸° ìœ„í•¨
    - í™•ì¸ì˜ ëŒ€ìƒ, ì¡°ê±´ì´ ëª…í™•í•˜ê³  ê°„ë‹¨í• ìˆ˜ë¡ ì¢‹ìŒ â†’ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì˜ í¸ë¦¬í•¨
- í…ŒìŠ¤íŠ¸ëŠ” ìë™ìœ¼ë¡œ ìˆ˜í–‰ë˜ë„ë¡ ì½”ë“œë¡œ ë§Œë“¤ì–´ì§€ëŠ” ê²ƒì´ ì¤‘ìš”í•¨

<br>

## 1.2 UserDaoTestì˜ ë¬¸ì œì 
- ìˆ˜ë™ í™•ì¸ ì‘ì—…ì˜ ë²ˆê±°ë¡œì›€
    - ì…ë ¥í•œ ê°’ê³¼ ê°€ì ¸ì˜¨ ê°’ì´ ì¼ì¹˜í•˜ëŠ”ì§€ë¥¼ ì‚¬ëŒì´ ì§ì ‘ í™•ì¸í•´ì•¼ í•¨
- ì‹¤í–‰ ì‘ì—…ì˜ ë²ˆê±°ë¡œì›€
    - ë§¤ë²ˆ ë©”ì†Œë“œë¥¼ ì§ì ‘ ì‹¤í–‰í•´ì•¼ í•¨
    - ë©”ì†Œë“œì˜ ê°œìˆ˜ê°€ ë§ì•„ì§€ë©´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë° ê²°ê³¼ í™•ì¸ ì‘ì—…ì˜ ë³¼ë¥¨ì´ ì»¤ì§

<br><br>

# 2. UserDaoTest ê°œì„  - JUnit
- í”„ë ˆì„ì›Œí¬
- ë”°ë¼ì„œ IoCì— ì˜í•´ ì£¼ë„ì ìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ íë¦„ì„ ì œì–´í•´ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•¨
    - main() í•¨ìˆ˜ë¥¼ ê°€ì§€ì§€ ì•ŠìŒ
- ìš”êµ¬ ì¡°ê±´
    - ë©”ì†Œë“œê°€ publicìœ¼ë¡œ ì„ ì–¸ë˜ì–´ì•¼ í•¨
    - ë©”ì†Œë“œì— `@Test` ì• ë…¸í…Œì´ì…˜ ë¶™ì—¬ì•¼ í•¨
- ê²€ì¦ ì½”ë“œ
    - if-elseë¬¸ì„ ëŒ€ì‹ í•´ `assertThat` ë©”ì†Œë“œ ì‚¬ìš©
        - ì²« ë²ˆì§¸ íŒŒë¼ë¯¸í„° ê°’ì„ ë’¤ì— ë‚˜ì˜¤ëŠ” match ì¡°ê±´ê³¼ ë¹„êµ
- `JUnitì„ ì´ìš©í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œ`
    
    ```java
    public class UserDaoTest {
    	@Test
    	public void addAndGet() throws SQLException { 
    		Applicationcontext context = new ClassPathXmlApplicationContext("applicationcontext.xml");
    		UserDao dao = context.getBean("userDao", UserDao.class);
    		
    		User user = new User();
    		user.setId("gyumee");
    		user.setName("ë°•ì„±ì² ");
    		user.setPassword("springno1");
    		
    		dao.add(user);
    		
    		User user2 = dao.get(user.getId());
    		
    		assertThat(user2.getName(), is(user.getName()));
    		assertThat(user2.getPassword(), is(user.getPassword()));
    	}
    }
    ```
    
- `JUnit í…ŒìŠ¤íŠ¸ ì‹œì‘`
    - Javaë¡œ ì‘ì„±ëœ ì–¸ì–´ì´ê¸° ë•Œë¬¸ì— ì–´ë””ì„ ê°€ í•´ë‹¹ í…ŒìŠ¤íŠ¸ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ëŠ” ì½”ë“œê°€ ì‘ì„±ë˜ì–´ì•¼ í•¨
    
    ```java
    public static void main(String[] args) {
    	JUnitCore.main("springbook.user.dao.UserDaoTest")ï¼›
    }
    ```

<br><br> 


# 3. JUnit
## 3.1 í…ŒìŠ¤íŠ¸ ê²°ê³¼ì˜ ì¼ê´€ì„±

> í…ŒìŠ¤íŠ¸ê°€ ì™¸ë¶€ ìƒíƒœì— ë”°ë¼ ì„±ê³µ ì—¬ë¶€ê°€ ë³€ê²½ëœë‹¤ë©´ ? â†’ DB ìƒíƒœ ì´ˆê¸°í™”ê°€ í•„ìš”í•¨


- `deleteAll()`
    - User í…Œì´ë¸”ì˜ ëª¨ë“  ë ˆì½”ë“œ ì‚­ì œí•˜ê¸°    
    ```java
    public void deleteAll() throws SQLException, ClassNotFoundException {
            Connection c = connectionMaker.makeConnection();
        
            PreparedStatement ps = c.prepareStatement("delete from users1");
            ps.executeUpdate();
            ps.close();
            c.close();
        }
    ```
        
- `getCount()`
    - User í…Œì´ë¸”ì˜ ë ˆì½”ë“œ ê°œìˆ˜ ë°˜í™˜
    ```java
    public int getCount() throws SQLException, ClassNotFoundException {
              Connection c = connectionMaker.makeConnection();
            PreparedStatement ps = c.prepareStatement("select count(*) from users");
        
            ResultSet rs = ps.executeQuery();
            rs.next();
            int count = rs.getInt(1);
        
            rs.close();
            ps.close();
            c.close();
            return count;
        }
    ```
        
- ë‘ ë©”ì†Œë“œ ê²€ì¦ì„ ìœ„í•´ ê¸°ì¡´ í…ŒìŠ¤íŠ¸ ì½”ë“œ ìˆ˜ì •
    - ìœ„ì˜ ë‘ ë©”ì†Œë“œë¥¼ í†µí•´ í…ŒìŠ¤íŠ¸ê°€ ë°˜ë³µì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤ê³  í•´ë„ í•­ìƒ ë™ì¼í•œ ê²°ê³¼ê°€ ë‚˜ì˜¬ ìˆ˜ ìˆìŒ
    - `addAndGet test code`
        
        ```java
        @Test
        public void addAndGet() throws SQLException {
        	...
        	dao.deleteAll();
        	assertThat(dao.getCount(), is(0));
        	
        	User user = new User();
        	user.setld("gyumee");
        	user.setName("ë°•ì„±ì² ");
        	user.setPassword("springno1");
        	
        	dao.add(user);
        	assertThat(dao.getCount(), is(1));
        	
        	User user2 = dao.get(user.getld());
        	assertThat(user2.getName(), is(user.getName()));
        	assertThat(user2.getPassword(), is(user.getPassword()));
        }
        ```

<br>


## 3.2 í¬ê´„ì ì¸ í…ŒìŠ¤íŠ¸
> JUnitì€ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ìˆœì„œë¥¼ ë³´ì¥í•´ì£¼ì§€ ì•ŠìŒ 
ê° í…ŒìŠ¤íŠ¸ëŠ” ë…ë¦½ì ìœ¼ë¡œ í•­ìƒ ë™ì¼í•œ ê²°ê³¼ë¥¼ ë‚¼ ìˆ˜ ìˆì–´ì•¼ í•¨

- `getCount()` test
    - ì‹œë‚˜ë¦¬ì˜¤ : User í…Œì´ë¸” ì´ˆê¸°í™” í›„ ë ˆì½”ë“œ ê°œìˆ˜ê°€ 0ì„ì„ í™•ì¸í•¨ 3ê°œì˜ ì‚¬ìš©ì ì •ë³´ë¥¼ í•˜ë‚˜ì”© ì¶”ê°€í•˜ë©´ì„œ getCount()ì˜ ê²°ê³¼ë¥¼ í™•ì¸í•¨
    - `User ìƒì„±ì ì¶”ê°€`
        
        ```java
        public User(String id, String name, String password) {
        	this.id = id;
        	this.name = name;
        	this.password = password;
        }
        
        // ì„ì˜ì˜ ìƒì„±ìë¥¼ ì¶”ê°€ë¡œ ë§Œë“ ë‹¤ë©´, ë””í´íŠ¸ ìƒì„±ìë„ í•¨ê»˜ ì¶”ê°€í•´ì•¼ í•¨
        public User() {
        }
        ```
        
    - `getCount() test`
        
        ```java
        Â©Test
        public void count() throws SQLException {
        	ApplicationContext context = new GenericXmlApplicationContext ("applicationcontext,xml");
        	UserDao dao = context.getBean("userDao", UserDao.class);
        	User userl = new User("gyumee", "ë°•ì„±ì² ", "springnol");
        	User user2 = new User("leegw70O", "ì´ê¸¸ì›",	"springno2");
        	User user3 = new User("bumjin", "ë°•ë²”ì§„", "springno3");
        
        	dao.deleteAll();
        	assertThat(dao.getCount(), is(0));
        	dao.add(user1);
        	assertThat(dao.getCount(), is(1));
        	dao.add(user2);
        	assertThat(dao.getCount(), is(2));
        	dao.add(user3);
        	assertThat(dao.getCount(), is(3));
        }
        ```
        
- `addAndGet()` test ë³´ì™„
    - ì‹œë‚˜ë¦¬ì˜¤ : ë‘ Userì„ addí•˜ê³  ê° User idë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬í•´ get() ë©”ì†Œë“œ ì‹¤í–‰í•¨
    - `addAndGet`
        
        ```java
        Â©Test
        public void addAndGet() throws SQLException {
        	...
        	UserDao dao = context.getBean("userDao", UserDao.class);
        	User user1 = new User("gyumee", "ë°•ì„±ì² ", "springnol");
        	User user2 = new User("leegw700", "ì´ê¸¸ì›", "springno2");
        	
        	dao.deleteAll();
        	assertThat(dao.getCount(), is(0));
        	
        	dao.add(user1);
        	dao.add(user2);
        	assertThat(dao.getCount(), is(2));
        
        	User userget1 = dao.get(user1.getId());
        	assertThat(userget1.getName(), is(user1.getName()));
        	assertThat(userget1.getPassword(), is(user1.getPassword()));
        	
        	User userget2 = dao.get(user2.getId());
        	assertThat(userget2.getName(), is(user2.getName()));
        	assertThat(userget2.getPassword(), is(user2.getPassword()));
        ```
        
- `get()` ì˜ˆì™¸ì¡°ê±´ í…ŒìŠ¤íŠ¸
    - idì— í•´ë‹¹í•˜ëŠ” ì‚¬ìš©ì ì •ë³´ê°€ ì—†ë‹¤ë©´ ?
        1. null ë¦¬í„´
        2. ì˜ˆì™¸ ë˜ì§ â†’ ì–´ë–»ê²Œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¡œ ì…ì¦í•  ê²ƒì¸ê°€?
    - `get() ìˆ˜ì •`
        
        ```java
        public User get(String id) throws SQLException {
        	...
        	ResultSet rs = ps.executeQuery()ï¼›
        	User user = null;
        	
        	if (rs.next()) {
        		user = new User();
        		user.setId(rs.getString("id"));
        		user.setName(rs.getString("name"));
        		user.setPassword(rs.getString("password"));
        	}
        	
        	rs.close();
        	ps.close();
        	c.close();
        	
        	// userê°€ nullì´ë©´ ì˜ˆì™¸ ë°˜í™˜
        	if (user == null) throw new EmptyResultDataAccessException(1);
        	
        	return user;
        }
        ```
        
    - `getUserFailure() test`
        - expected ë¥¼ í†µí•´ ë˜ì§ˆ ì˜ˆì™¸ì— ëŒ€í•´ ëª…ì‹œí•´ì¤Œ
        
        ```java
        @Test(expected=EmptyResultDataAccessException.class)
        public void getUserFailure() throws SQLException { 
        	Applicationcontext context = new GenericXmlApplicationContext("applicationcontext.xml");
        	UserDao dao = context.getBean("userDao", UserDao.class);
        
        	dao.deleteAll();
        	assertThat(dao.getCount(), is(0));
        	
        	dao.get("unknown_id");
        }
        ```

<br><br>


## 3.4 í…ŒìŠ¤íŠ¸ ì½”ë“œ ê°œì„ 

- `@Before`
    - í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•  ë•Œë§ˆë‹¤ ë°˜ë³µë˜ëŠ” ì¤€ë¹„ ì‘ì—…ì„ ë¨¼ì € ì‹¤í–‰ì‹œì¼œì¤Œ
    - **ë¡œì»¬ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¡œ ë³€ê²½í•´ ì‚¬ìš©**
    - `userDaoTest`
        
        ```java
        public class UserDaoTest {
        	private UserDao dao;
        	
        	@Before
        	public void setUp() {
        		Applicationcontext context = new GenericXmlApplicationContext("applicationContext.xml");
        		this.dao = context.getBean("userDao", UserDao.class);
        	}
        	
        	@Test
        	...
        }
        ```
        
- ğŸ“Œ **Junitì˜ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ ê³¼ì •**
    1. í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì—ì„œ í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œë¥¼ ëª¨ë‘ ì°¾ìŒ
    2. í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì˜ objectë¥¼ ë§Œë“¦ â†’ ë…ë¦½ ì‹¤í–‰ ë³´ì¥
    3. `@Before` ë©”ì†Œë“œ ì‹¤í–‰
    4. `@Test` ê°€ ë¶™ì€ ë©”ì†Œë“œ í•˜ë‚˜ í˜¸ì¶œí•˜ê³  í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ ì €ì¥í•¨
    5. `@After` ë©”ì†Œë“œ ì‹¤í–‰
    6. ë‚˜ë¨¸ì§€ í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œì— ëŒ€í•´ í•´ë‹¹ ì‘ì—… ë°˜ë³µ
    7. ëª¨ë“  í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì¢…í•©í•´ ë°˜í™˜
- í”½ìŠ¤ì²˜
    - í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ëŠ” ë° í•„ìš”í•œ ì •ë³´ë‚˜ ì˜¤ë¸Œì íŠ¸
    - ì—¬ëŸ¬ í…ŒìŠ¤íŠ¸ì— ë°˜ë³µì ìœ¼ë¡œ ì‚¬ìš©ë¨ â†’ ì£¼ë¡œ `@Before`ì„ ì´ìš©í•´ ìƒì„±ë¨

<br><br>

# 4. Spring Test
- í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œ ê°œìˆ˜ë§Œí¼ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ë„ ë§Œë“¤ì–´ì§
    - ëª¨ë“  ì‹±ê¸€í†¤ ë¹ˆ ì˜¤ë¸Œì íŠ¸ë¥¼ ì´ˆê¸°í™”í•¨ â†’ ì´ˆê¸°í™” ê³¼ì •ì—ì„œ ë§ì€ ì‹œê°„ì´ í•„ìš”í•¨
    - ë…ìì ìœ¼ë¡œ ë§ì€ ë¦¬ì†ŒìŠ¤ í• ë‹¹ ë° ìŠ¤ë ˆë“œë¥¼ ë„ìš°ëŠ” ë¹ˆì´ ìˆì„ ìˆ˜ë„ ìˆìŒ â†’ ë¦¬ì†ŒìŠ¤ ì •ë¦¬ í•„ìš” <br>
**â†’ í•œ ë²ˆë§Œ ìƒì„±í•˜ê³  í…ŒìŠ¤íŠ¸ ì „ì²´ê°€ ê³µìœ í•´ì„œ ì‚¬ìš©í•¨**

- ì´ˆê¸°í™”í•˜ê³  ë‚˜ë©´ ì‹±ê¸€í†¤ì´ê¸° ë•Œë¬¸ì— ìƒíƒœë¥¼ ê°–ì§€ ì•Šì•„ ì—¬ëŸ¬ í…ŒìŠ¤íŠ¸ê°„ ê³µìœ í•´ë„ ë¬¸ì œê°€ ì—†ìŒ

<br>

## 4.1 í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ ê´€ë¦¬
### 4.1.1 Test Context Framework

- í…ŒìŠ¤íŠ¸ ì»¨í…ìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬
    - JUnitì˜ ì§€ì›ì„ ë°›ì•„ ê°„ë‹¨í•œ ì• ë…¸í…Œì´ì…˜ìœ¼ë¡œ ì„¤ì • ê°€ëŠ¥
    - í…ŒìŠ¤íŠ¸ì—ì„œ í•„ìš”ë¡œ í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì–´ ëª¨ë“  í…ŒìŠ¤íŠ¸ê°€ ê³µìœ í•˜ê²Œ í•  ìˆ˜ ìˆìŒ
    - ê¸°ì¡´ ì• í”Œë¦¬ì¼€ì´ì…˜ í…ìŠ¤íŠ¸ë³´ë‹¤ í•´ë‹¹ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë” í¸ë¦¬í•¨

```java
// test context frameworkë¥¼ ì˜ë¯¸
@RunWith(SpringJUnit4ClassRunner.class)
// text contextê°€ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì¤„ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ì˜ ìœ„ì¹˜
@ContextConfiguration(locations="/applicationContext.xml")
public class UserDaoTest {
	
	// test objê°€ ë§Œë“¤ì–´ì§€ë©´ spring test contextì— ì˜í•´ ìë™ìœ¼ë¡œ ê°’ì´ ì£¼ì…ë¨
	@Autowired
	private ApplicationContext context;

	@Before
	public void setUp() {
		this.dao = this.context.getBean("userDao", UserDao.class);
		...
	}	
}		
```

- `@RunWith` : Junit framework í…ŒìŠ¤íŠ¸ ì‹œ ì‚¬ìš©í•¨
- `@ContextConfiguration` : ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì¤„ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ì˜ ì„¤ì • íŒŒì¼ ìœ„ì¹˜ ì§€ì •
- contextì— ê°’ì„ ë„£ëŠ” ì½”ë“œê°€ ì—†ì§€ë§Œ text context frameworkê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ ê°’ì„ ìë™ìœ¼ë¡œ ì£¼ì…í•´ì¤Œ

<br>

### 4.1.2 Test methodì˜ Context ê³µìœ 

- í•˜ë‚˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ê°€ ë§Œë“¤ì–´ì ¸ ëª¨ë“  í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œì— ì‚¬ìš©ë¨
- ê·¸ëŸ¬ë‚˜ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì˜ objëŠ” ì‹¤í–‰í•  ë•Œë§ˆë‹¤ ì£¼ì†Œê°’ì´ ë°”ë€œ
- ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ ìƒì„± ë°©ë²•
    - JUnitì€ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì „ í•œ ë²ˆ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í•¨
    - í…ŒìŠ¤íŠ¸ ì˜¤ë¸Œì íŠ¸ê°€ ìƒì„±ë  ë•Œë§ˆë‹¤ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ í…ŒìŠ¤íŠ¸ ì˜¤ë¸Œì íŠ¸ì˜ íŠ¹ì • í•„ë“œì— ì£¼ì…í•¨
- ìµœì´ˆì˜ í…ŒìŠ¤íŠ¸ ë•Œë§Œ ê°€ì¥ ë§ì€ ì‹œê°„ì´ ì†Œìš”ë¨

<br>

### 4.1.3 Test Classì˜ Context ê³µìœ 

- ì—¬ëŸ¬ ê°œì˜ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ê°€ ìˆëŠ”ë° ëª¨ë‘ ê°™ì€ ì„¤ì • íŒŒì¼ì„ ê°€ì§„ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ ì‚¬ì´ì—ì„œë„ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ê³µìœ í•  ìˆ˜ ìˆìŒ
- ì•„ë˜ ë‘ í´ë˜ìŠ¤ëŠ” ë™ì¼í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•¨

```java
@RunWith(SpringJUnit4ClassRunner.class)
Â©ContextConfiguration(locations="/applicationcontext.xml") 
public class UserDaoTest { .. }

@RunWith(SpringJUnit4ClassRunner.class)
Â©ContextConfiguration(locations="/applicationContext.xml")
public class GroupDaoTest { .. }
```

<br>

### 4.1.4 @Autowired

- test context frameworkëŠ” í•´ë‹¹ ì• ë…¸í…Œì´ì…˜ì´ ë¶™ì€ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ì˜ íƒ€ì…ê³¼ ì¼ì¹˜í•˜ëŠ” ì»¨í…ìŠ¤íŠ¸ ë‚´ì˜ ë¹ˆì„ ì°¾ìŒ
- ì¼ì¹˜í•˜ë‹¤ë©´ í•´ë‹¹ ë¹ˆì„ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ì— ì£¼ì…í•¨
    - ì¼ë°˜ì ìœ¼ë¡œ ìƒì„±ì, ìˆ˜ì •ì ë©”ì†Œë“œê°€ í•„ìš”í•˜ë‚˜ í•´ë‹¹ ê²½ìš°ëŠ” ì—†ì–´ë„ ê°€ëŠ¥í•¨
    â†’ **ìë™ì™€ì´ì–´ë§**
    
- ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ëŠ” ì´ˆê¸°í™” ì‹œ ìê¸° ìì‹ ë„ ë¹ˆìœ¼ë¡œ ë“±ë¡í•¨
    - ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ì—ëŠ” ApplicationContext íƒ€ì…ì˜ ë¹ˆì´ ì¡´ì¬
    - â†’ í•´ë‹¹ íƒ€ì…ì— ëŒ€í•´ ìë™ì™€ì´ì–´ë§ì„ í†µí•œ DIê°€ ê°€ëŠ¥í•¨
- ê°™ì€ íƒ€ì…ì˜ ë¹ˆì´ ë‘ ê°œ ì´ìƒ ìˆëŠ” ê²½ìš° ì–´ë–¤ ë¹ˆì„ ê°€ì ¸ì˜¬ì§€ ê²°ì •í•  ìˆ˜ ì—†ìŒ
    - íƒ€ì…ìœ¼ë¡œë§Œ ê²°ì •í•  ìˆ˜ ì—†ëŠ” ê²½ìš° ë³€ìˆ˜ì˜ ì´ë¦„ê³¼ ê°™ì€ ì´ë¦„ì˜ ë¹ˆì´ ìˆëŠ”ì§€ í™•ì¸í•¨ (ì—†ë‹¤ë©´ ì˜ˆì™¸ ë°œìƒ)
    - dataSource, dataSource2 ë‘ ê°œì˜ ë¹ˆì´ ìˆë‹¤ë©´ ì „ìê°€ ì£¼ì…ë¨
    
    ```java
    @Autowired
    Datasource dataSource;
    ```
<br><br>


## 4.2 DIì™€ í…ŒìŠ¤íŠ¸

- ì¸í„°í˜ì´ìŠ¤ë¥¼ ë‘ê³  DIë¥¼ ì ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ
    - í´ë˜ìŠ¤ì˜ ë³€ê²½ ê°€ëŠ¥ì„±ì´ 0ì¼ ìˆ˜ëŠ” ì—†ê¸° ë•Œë¬¸ì— ë³€ê²½ ê°€ëŠ¥ì„±ì„ ì—´ì–´ ë‘¬ì•¼ í•¨
    - ë‹¤ë¥¸ ì°¨ì›ì˜ ì„œë¹„ìŠ¤ ê¸°ëŠ¥ ë„ì…ì„ ìœ„í•¨
    - íš¨ìœ¨ì ì¸ í…ŒìŠ¤íŠ¸ ìƒì„±ì„ ìœ„í•¨

### 4.2.1 í…ŒìŠ¤íŠ¸ ì½”ë“œì— ì˜í•œ DI

- `DataSource` ë¹ˆ : ì„œë²„ì˜ DB í’€ ì„œë¹„ìŠ¤ì™€ ì—°ê²°í•´ ìš´ì˜ìš© DB ì»¤ë„¥ì…˜ì„ ë°˜í™˜í•œë‹¤ê³  ê°€ì •
    - í…ŒìŠ¤íŠ¸ ì¤‘ `deleteAll()`ì— ì˜í•´ ìš´ì˜ìš© DBì˜ ëª¨ë“  ì •ë³´ê°€ ì‚­ì œë  ìˆ˜ë„ ìˆìŒ
    
    â†’ xml ìˆ˜ì •ë³´ë‹¤ í…ŒìŠ¤íŠ¸ì½”ë“œì— ì˜í•œ DIë¥¼ ì´ìš©í•´ DataSource objë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŒ
    
- `SingleConnectionDataSource`
    - ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê°€ì¥ ë¹ ë¥¸ DataSourceë¡œ DataSource êµ¬í˜„ í´ë˜ìŠ¤ì„
    - @Before ì—ì„œ ì¤€ë¹„ëœ í…ŒìŠ¤íŠ¸ìš© DataSource objë¥¼ ìƒì„±í›„ DI ìˆ˜í–‰
    - í…ŒìŠ¤íŠ¸ ì§„í–‰ ë™ì•ˆ í…ŒìŠ¤íŠ¸ìš© DataSourceë¥¼ ì´ìš©í•´ ë™ì‘í•˜ê²Œ ë³€ê²½
- ì¥ì 
    - xmlì„ ìˆ˜ì •í•˜ì§€ ì•Šê³ ë„ ì˜¤ë¸Œì íŠ¸ ê´€ê³„ë¥¼ ì¬êµ¬ì„±í•  ìˆ˜ ìˆìŒ
    - ì˜ˆì™¸ì ì¸ ìƒí™©ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- ë‹¨ì 
    - ì„¤ì • ì •ë³´ì— ë”°ë¼ êµ¬ì„±ëœ ì˜¤ë¸Œì íŠ¸ì˜ ì˜ì¡´ ê´€ê³„ë¥¼ ê°•ì œë¡œ ë³€ê²½
        
        â†’ ë‹¤ë¥¸ ëª¨ë“  í…ŒìŠ¤íŠ¸ì—ë„ í•´ë‹¹ ë‚´ìš©ì´ ì ìš©ë¨
        
        â†’ `@DirtiesContext` : í•´ë‹¹ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì— ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ ê³µìœ ë¥¼ í—ˆìš©í•˜ì§€ ì•ŠìŒ
        
        - ë©”ì†Œë“œ ìˆ˜í–‰ í›„ ìƒˆë¡œìš´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í•¨
- `UserDaoTest`
    
    ```java
    // ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ì˜ êµ¬ì„±/ìƒíƒœë¥¼ ë³€ê²½í•œë‹¤ëŠ” ê²ƒì„ ëª…ì‹œ
    @DirtiesContext 
    public class UserDaoTest {
    	@Autowired
    	UserDao dao;
    
    	@Before
    	public void setUp() {
    		// ì‚¬ìš©í•  datasource object ì§ì ‘ ìƒì„±
    		DataSource dataSource = new SingleConnectionDataSource("jdbc:mysql://localhost/testdb", "spring", "book", true);
    		// ì½”ë“œì— ì˜í•œ ìˆ˜ë™ DI
    		dao.setDataSource(dataSource);
    	}
    	...
    }
    ```

<br>

### 4.2.2 í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ DI ì„¤ì •

> í…ŒìŠ¤íŠ¸ì— ìˆ˜ë™ìœ¼ë¡œ DI â†’ ì½”ë“œê°€ ë§ì•„ì§€ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë§¤ë²ˆ ìƒˆë¡œ ë§Œë“¤ì–´ì•¼ í•´ì„œ ë²ˆê±°ë¡œì›€

- í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì„¤ì • íŒŒì¼ ë”°ë¡œ ë§Œë“¤ì–´ë‘ê¸°
    - í…ŒìŠ¤íŠ¸ì—ì„œ ì‚¬ìš©í•  DataSource í´ë˜ìŠ¤ê°€ ë¹ˆìœ¼ë¡œ ì •ì˜ëœ ì„¤ì • íŒŒì¼ì„ ìš´ì˜ìš© ì„¤ì • íŒŒì¼ê³¼ ë¶„ë¦¬
    - test-applicationContext.xml íŒŒì¼ì„ ìƒì„±
    - DBë§Œ í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ ë³€ê²½
    - `@ContextConfiguration` ì˜ locations ê°’ì„ í…ŒìŠ¤íŠ¸ìš© ì„¤ì • íŒŒì¼ë¡œ ë³€ê²½í•¨

<br>

### 4.2.3 ì»¨í…Œì´ë„ˆ ì—†ëŠ” DI í…ŒìŠ¤íŠ¸

> DI ì»¨í…Œì´ë„ˆì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ” í…ŒìŠ¤íŠ¸

- UserDaoTest
    - UserDao ì½”ë“œê°€ DAOë¡œì„œ DBì— ì •ë³´ë¥¼ ì˜ ë“±ë¡í•˜ê³  ê°€ì ¸ì˜¤ëŠ”ì§€ë¥¼ í™•ì¸
    - UserDaoê°€ ìŠ¤í”„ë§ì— ì˜ì¡´í•˜ì§€ ì•Šê³  ìì‹ ì˜ ê´€ì‹¬ì—ê²Œë§Œ ì§‘ì¤‘í•˜ê²Œ ë§Œë“¦ â†’ ê¹”ë”í•œ í…ŒìŠ¤íŠ¸
        - ì»¨í…Œì´ë„ˆê°€ DIë¥¼ ê°€ëŠ¥í•˜ê²Œ í•´ì£¼ëŠ” ê²ƒì€ ì•„ë‹˜ (ë„ì›€ì„ ì¤Œ)
- `UserDaoTest`
    - RunWith, Autowired ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
    
    ```java
    public class UserDaoTest {
    	// Autowired ì‚¬ìš© X
    	UserDao dao;
    	
    	@Before
    	public void setUp() {
    		dao = new UserDao();
    		DataSource dataSource = new SingleConnectionDataSource("jdbcï¼šmysqlï¼š//localhost/testdb", "spring", "book", true);
    		// ì˜¤ë¸Œì íŠ¸ ìƒì„±ì„ ì§ì ‘ ìˆ˜í–‰
    		dao.setDataSource(dataSource);
    	}
    }
    ```